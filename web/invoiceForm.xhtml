<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Kamak Paperless</title>

    <style>
        body {
            background: linear-gradient(235deg, #000000, #ff2b2b);
            font-family: 'Segoe UI', Roboto, sans-serif;
            color: #111111;
        }

        /* Main container */
        .main-container {
            width: 90%;
            max-width: 1200px;
            margin: 40px auto;
        }

        /* Cards */
        .modern-card {
            background: #ffffff;
            padding: 25px;
            border-radius: 14px;
            border: 1px solid #e5e5e5;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }

        /* Section titles */
        .section-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 18px;
            color: #000000;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-left: 4px solid #c00000;
            padding-left: 10px;
        }

        /* Company box */
        .company-box {
            text-align: left;
            background: linear-gradient(135deg, #000000 0%, #1a0000 40%, #ff2b2b 100%);
            color: #ffffff;
            padding: 18px 22px;
            border-radius: 12px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
        }

        .company-name {
            font-size: 20px;
            font-weight: 700;
            margin: 0;
            color: #ffffff;
        }

        .company-details {
            font-size: 13px;
            margin-top: 6px;
            line-height: 1.6;
            color: #ffffff;
        }

        /* Form section wrapper */
        .form-section {
            border: 1px solid #e5e5e5;
            border-radius: 14px;
            padding: 20px;
            background: #ffffff;
        }

        /* Remove PrimeFaces default panel borders */
        .ui-panelgrid,
        .ui-panelgrid-content {
            border: none !important;
            background: transparent !important;
        }

        /* ðŸ”´ Input fields */
        .p-inputtext,
        .p-inputtextarea,
        .p-calendar input {
            border-radius: 10px !important;
            border: 1px solid #cccccc !important;
            background: #ffffff !important;
            padding: 10px 14px !important;
            box-shadow: none !important;
            transition: all 0.2s ease-in-out;
        }

        /* Hover */
        .p-inputtext:hover,
        .p-inputtextarea:hover,
        .p-calendar input:hover {
            border-color: #c00000 !important;
        }

        /* Focus (Red Accent Glow) */
        .p-inputtext:focus,
        .p-inputtextarea:focus,
        .p-calendar input:focus {
            border-color: #c00000 !important;
            box-shadow: 0 0 0 3px rgba(192, 0, 0, 0.15) !important;
            outline: none !important;
        }

        /* DataTable */
        .p-datatable {
            border-radius: 12px;
            overflow: hidden;
        }

        .p-datatable thead th {
            background: #000000 !important;
            color: #ffffff !important;
            border: none !important;
        }

        .p-datatable tbody tr:nth-child(even) {
            background: #f8f8f8;
        }

        /* Primary button (Save) */
        .p-button-primary {
            background: #c00000 !important;
            border: none !important;
        }

        .p-button-primary:hover {
            background: #a00000 !important;
        }

        /* Add button */
        .p-button-success {
            background: #000000 !important;
            border: none !important;
            color: #f8f8f8;
        }
        
        .existing-section {
            display: flex;
            align-items:flex-start;
        }

        .p-button-success:hover {
            background: #ffffff !important;
            color: #000000;
            height: auto; 
        }
        
        /* White company button */
        .company-btn-white {
            background: #ffffff !important;
            color: #000000 !important;
            border: 1px solid #ffffff !important;
            border-radius: 5px !important;
            padding: 4px 8px !important;
            transition: all 0.2s ease-in-out;
            font-size: 14px;
        }
        
        /* Client Grid Layout */
        .client-grid {
            row-gap: 18px !important;
        }

        /* Label column */
        .label-col {
            width: 100%;
            font-weight: 600;
            display: flex;
            align-items: center;
            color: #333;
        }

        /* Field column */
        .field-col {
            width: 100%;
        }

        /* Make dropdown full width */
        .full-width {
            width: 100% !important;
        }

        /* Improve textarea spacing */
        .client-grid textarea {
            resize: vertical;
        }

        /* Improve selectOneMenu styling */
        .p-selectonemenu {
            width: 100% !important;
            border-radius: 10px !important;
            border: 1px solid #cccccc !important;
        }

        /* Hover effect */
        .company-btn-white:hover {
            background: #f2f2f2 !important;
            color: #000000 !important; /* makes text visible on hover */
        }

        /* Save button sizing */
        .save-btn {
            width: 100%;
            height: 50px;
            font-size: 16px;
            text-align: center;
            background: #000000;
            color: #ffffff;
            border-radius: 12px;
            border: none;
        }
        
        /* Two column layout */
        .two-column-layout {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }

        /* Make both cards equal width */
        .two-column-layout .modern-card {
            flex: 1;
            margin-bottom: 30px;
        }

        /* Responsive: Stack on smaller screens */
        @media (max-width: 992px) {
            .two-column-layout {
                flex-direction: column;
            }
        }
    </style>
</h:head>

<h:body>
<div class="main-container">
<h:form>

    <!-- COMPANY -->
    <div class="company-box">
        <div>
            <div>
                <div class="company-name">#{companyBean.company.name}</div>
                <div class="company-details">
                    #{companyBean.company.streetAddress}<br/>
                    #{companyBean.company.city}<br/>
                    #{companyBean.company.email}<br/>
                    #{companyBean.company.phone}
                </div>
            </div>
            <div>
                <p:commandButton value="Edit Company"
                    icon="pi pi-pencil"
                    action="companyEdit?faces-redirect=true"
                    style="margin-top:10px;"
                    styleClass="company-btn-white"/>
            </div>
        </div>
    </div>

    <!-- INVOICE INFO -->
    <div class="modern-card">
        <div class="section-title">Invoice Info</div>

        <div class="form-section">
            <p:panelGrid columns="2" layout="grid" styleClass="ui-fluid">
                <p:outputLabel value="Invoice Number"/>
                <p:inputText value="#{invoiceBean.invoice.invoiceNumber}" required="true"/>
            </p:panelGrid>
        </div>
    </div>

    <!-- ðŸ”¥ CLIENT + DETAILS SIDE BY SIDE -->
    <div class="two-column-layout">

        <!-- CLIENT -->
        <div class="modern-card">
            <div class="section-title">Client Information</div>

            <div class="form-section">
                <p:panelGrid columns="1" 
                            layout="grid" 
                            columnClasses="label-col,field-col"
                            styleClass="ui-fluid client-grid">

                   <!-- Existing Client -->
                   <p:outputLabel value="Select Existing Client"/>
                   <p:selectOneMenu value="#{invoiceBean.selectedClientId}">
                       <f:selectItem itemLabel="-- New Client --" itemValue="#{null}" />
                       <f:selectItems value="#{clientBean.clients}"
                                      var="client"
                                      itemLabel="#{client.name}"
                                      itemValue="#{client.id}" />
                   </p:selectOneMenu>

                   <!-- Name -->
                   <p:outputLabel value="Client Name"/>
                   <p:inputText value="#{invoiceBean.newClient.name}"
                                disabled="#{invoiceBean.selectedClientId != null}"/>

                   <!-- Address -->
                   <p:outputLabel value="Address"/>
                   <p:inputTextarea value="#{invoiceBean.newClient.address}"
                                    rows="3"
                                    disabled="#{invoiceBean.selectedClientId != null}"/>

                   <!-- Phone -->
                   <p:outputLabel value="Phone"/>
                   <p:inputText value="#{invoiceBean.newClient.phone}"
                                disabled="#{invoiceBean.selectedClientId != null}"/>

                   <!-- Email -->
                   <p:outputLabel value="Email"/>
                   <p:inputText value="#{invoiceBean.newClient.email}"
                                disabled="#{invoiceBean.selectedClientId != null}"/>

               </p:panelGrid>
            </div>
        </div>

        <!-- DETAILS -->
        <div class="modern-card">
            <div class="section-title">Invoice Details</div>

            <div class="form-section">
                <p:panelGrid columns="2" layout="grid" styleClass="ui-fluid">
                    <p:outputLabel value="Issue Date"/>
                    <p:calendar value="#{invoiceBean.invoice.issueDate}"
                                pattern="yyyy-MM-dd"/>

                    <p:outputLabel value="Due Date"/>
                    <p:calendar value="#{invoiceBean.invoice.dueDate}"
                                pattern="yyyy-MM-dd"/>

                    <p:outputLabel value="Tax Rate (%)"/>
                    <p:inputText value="#{invoiceBean.invoice.taxRate}"/>

                    <p:outputLabel value="Discount"/>
                    <p:inputText value="#{invoiceBean.invoice.discount}"/>

                    <p:outputLabel value="Terms"/>
                    <p:inputTextarea value="#{invoiceBean.invoice.terms}" rows="3"/>
                </p:panelGrid>
            </div>
        </div>

    </div>

    <!-- ADD ITEM -->
    <div class="modern-card">
        <div class="section-title">Add Item</div>

        <div class="form-section">
            <p:panelGrid columns="4" layout="grid" styleClass="ui-fluid">
                <p:inputText value="#{invoiceBean.newItem.description}" placeholder="Description"/>
                <p:inputText value="#{invoiceBean.newItem.hours}" placeholder="Hours"/>
                <p:inputText value="#{invoiceBean.newItem.rate}" placeholder="Rate"/>

                <p:commandButton value="Add"
                                 icon="pi pi-plus"
                                 styleClass="p-button-success"
                                 actionListener="#{invoiceBean.addItem}"
                                 update="itemsTable"/>
            </p:panelGrid>
        </div>
    </div>

    <!-- ITEMS TABLE -->
    <div class="modern-card">
        <div class="section-title">Invoice Items</div>

        <p:dataTable id="itemsTable"
                     value="#{invoiceBean.invoice.items}"
                     var="item">

            <p:column headerText="Description">
                #{item.description}
            </p:column>

            <p:column headerText="Hours">
                #{item.hours}
            </p:column>

            <p:column headerText="Rate">
                #{item.rate}
            </p:column>

            <p:column headerText="Amount">
                <b>#{item.amount}</b>
            </p:column>

        </p:dataTable>
    </div>

    <!-- SAVE -->
    <p:commandButton value="Generate &amp; Save Invoice"
                     icon="pi pi-check"
                     styleClass="p-button-primary save-btn"
                     action="#{invoiceBean.generateInvoice}"
                     update="@form"/>

</h:form>
</div>
</h:body>
</html>